---
title: "DS 6372 Project 1"
output: html_document
---
# World Health Organization

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(ggplot2)
library(plyr)
library(dplyr)
library(GGally)
library(tidyverse)
library(naniar)
library(zoom)
library(MASS)
```

## Context

Although there have been lot of studies undertaken in the past on factors affecting life expectancy considering demographic variables, income composition and mortality rates. It was found that affect of immunization and human development index was not taken into account in the past. Also, some of the past research was done considering multiple linear regression based on data set of one year for all the countries. Hence, this gives motivation to resolve both the factors stated previously by formulating a regression model based on mixed effects model and multiple linear regression while considering data from a period of 2000 to 2015 for all the countries. Important immunization like Hepatitis B, Polio and Diphtheria will also be considered. In a nutshell, this study will focus on immunization factors, mortality factors, economic factors, social factors and other health related factors as well. Since the observations this dataset are based on different countries, it will be easier for a country to determine the predicting factor which is contributing to lower value of life expectancy. This will help in suggesting a country which area should be given importance in order to efficiently improve the life expectancy of its population.

```{r}
# Reading datafile
Life_Expectancy_Df <- read.csv("../data\ /Life\ Expectancy\ Data.csv", header=TRUE)
Life_Expectancy_Df_2014 <- Life_Expectancy_Df %>% filter(Year == 2014) # Keeping ony 2014 data as per requirement
gg_miss_var(Life_Expectancy_Df_2014)

```


#### 1. Does various predicting factors which has been chosen initially really affect the Life expectancy? What are the predicting variables actually affecting the life expectancy?

```{r}



```

#### 2.Should a country having a lower life expectancy value(<65) increase its healthcare expenditure in order to improve its average lifespan?

```{r}


```

#### 3.How does Infant and Adult mortality rates affect life expectancy?

```{r}



```

#### 4.Does Life Expectancy has positive or negative correlation with eating habits, lifestyle, exercise, smoking, drinking alcohol etc.

```{r}



```

#### 5.What is the impact of schooling on the lifespan of humans?

```{r}



```

#### 6.Does Life Expectancy have positive or negative relationship with drinking alcohol?


```{r}


```

#### 7.Do densely populated countries tend to have lower life expectancy?


```{r}



```

#### 8.What is the impact of Immunization coverage on life Expectancy?


```{r}



```



## Objective 1
Display the ability to build regression models using the skills and discussions from Unit 1 and 2 with the purpose of identifying key relationships, interpreting those relationships, and making good predictions.  

*Reminder, key here is to tell a good story.*

### Build  Model 1
  - Identify key relationships
  - Ensure interpretability

1. Perform regression analysis
```{r}

```
2. Report predictive ability
    a. Test/train set
    b. CV data
```{r}

```

3. Hypothesis Testing
```{r}

```

4. Interpret the coefficients
```{r}

```

5. Confidence intervals
```{r}

```

6. Practical and statistical significance
```{r}

```

### Model 2

    - Product the best predictions as possible
    - Interpretation is no longer required, hence complexity is no longer an issue

1. Feature selection to avoid overfitting

```{r}

```

2. Create the model

```{r}

```

3. Compare model 1 vs. model 2

```{r}

```

4. Comment on the differences of the models and whether model 2 brings any benefit




## Objective 2
    - Nonparametric technique
    - kNN or regression trees (select one)

Set of predictors from previous regression: (fill this out)

1.  Model
```{r}

```

2.	A brief description of your nonparametric modelâ€™s strategy to make a prediction.  Include Pros and Cons.
```{r}

```
3.	Provide any additional details that you feel might be necessary to report.
```{r}

```
4.	Report the test ASE using this nonparametric model so we can see how well it does compared to regression.
```{r}

```

# EDA

## Suchi's EDA

```{r}

##############

#1. Does various predicting factors which has been chosen initially really affect the Life expectancy? What are the predicting variables actually affecting the life expectancy?

#ggplot(Life_Expectancy_Df_2014, aes (x = Life.expectancy , y = Country )) +  geom_col()  + ylab("Country Name ") + xlab("Life Expectancy") +  ggtitle("Distribution of Life Expectancy for country") + theme(axis.text.x = element_text(angle=90,hjust=1))


ggplot(Life_Expectancy_Df_2014, aes(x = Status , y = Life.expectancy )) +  geom_boxplot()  + xlab("Country's Status ") + ylab("Life Expectancy") +  ggtitle("Distribution of Life Expectancy for Developing vs Developed country") 


ggplot(Life_Expectancy_Df_2014, aes(x = infant.deaths, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Adult.Mortality, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = infant.deaths, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Alcohol, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = percentage.expenditure, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Hepatitis.B, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Measles , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x =  BMI , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = under.five.deaths , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Polio, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Total.expenditure, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Diphtheria , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x =  HIV.AIDS , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = GDP , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Population , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x =  thinness..1.19.years , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x =  thinness.5.9.years , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Income.composition.of.resources , y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Schooling , y = Life.expectancy )) +  geom_point()


##############

#2.Should a country having a lower life expectancy value(<65) increase its healthcare expenditure in order to improve its average lifespan?
#We need to divide the data into 2 categories like >65 and <65 to compare if total expenditure has significant impact on life expectancy.

Life_Expectancy_Df_2014 <- add_column(Life_Expectancy_Df_2014,  Life.expectancy = "Low", .after = "Schooling")
Life_Expectancy_Df_2014 <- Life_Expectancy_Df_2014 %>% mutate(Life.expectancy.1 = replace(Life.expectancy.1, Life.expectancy >= 65.0, "High"))

ggplot(Life_Expectancy_Df_2014, aes(x = Life.expectancy.1 , y = Total.expenditure )) +  geom_boxplot()  + xlab("Life Expectancy (More than 65 vs Less than 65) ") + ylab("Healthcare expenditure amount") +  ggtitle("Distribution of Healthcare expenditure for low vs high life expectancy") 

##############


#3.How does Infant and Adult mortality rates affect life expectancy?

ggplot(Life_Expectancy_Df_2014, aes(x = infant.deaths, y = Life.expectancy )) +  geom_point()
ggplot(Life_Expectancy_Df_2014, aes(x = Adult.Mortality, y = Life.expectancy )) +  geom_point()


##############


#4.Does Life Expectancy has positive or negative correlation with eating habits, lifestyle, exercise, smoking, drinking alcohol etc.



```


## Jamie's EDA
---

Linear correlations: 
- Schooling vs Income.composition.of.resource
- thinness..1.19.years vs thinness.5.9.years
- life exp. vs schooling
- life exp. vs income
- infant death vs under 5 death

removed variables that were correlated


```{r}
# print out summary for data
  summary (Life_Expectancy_Df_2014)

# matrix grid to determine correlated variables
  colnames(Life_Expectancy_Df_2014)
  pairs(Life_Expectancy_Df_2014[,c(4:9)])
  pairs(Life_Expectancy_Df_2014[,10:15])
  pairs(Life_Expectancy_Df_2014[,16:22])

# narrowed matrix without correlated variables
  ggpairs(Life_Expectancy_Df_2014[,c(4:5, 7:19, 22)],
        main = "WHO Data",
        pch = 10,
        aes(colour=Life_Expectancy_Df_2014$Status))
```

#### Regression Testing/Variables Reduction
---
Forward, backward, and stepwise regressions were run and all 3 resulted with the same 4 significant variables.

Variables
- Adult.Mortality  
- Total.expenditure
- HIV.AIDS 
- Income.composition.of.resources


```{r}
# regression selections
  
  # ETL
    # dummy code (developing = 1, developed = 0)
      values <- c(0, 1)
      Life_Expectancy_Df_2014$Status_dc <- values[Life_Expectancy_Df_2014$Status]
      Life_Expectancy_Df_2014_dc <- Life_Expectancy_Df_2014[,c(4:23)]
    # remove nulls
      df1_complete <- na.omit(Life_Expectancy_Df_2014_dc) 
      
  # Fit the full model 
    full.model <- lm(Life.expectancy ~., data = df1_complete)
    # Stepwise regression model
      step.model <- stepAIC(full.model, direction = "both", 
                        trace = FALSE)
      summary(step.model)
    # forward regression model
      foward.model <- stepAIC(full.model, direction = "forward", 
                        trace = FALSE)
      summary(foward.model)
    # backward regression model
      backward.model <- stepAIC(full.model, direction = "backward", 
                        trace = FALSE)
      summary(backward.model)
    

    
```











